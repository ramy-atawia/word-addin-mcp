<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Add-in MCP - E2E Working Product</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .content {
            padding: 40px;
        }
        
        .status {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: #e8f5e8;
            border-left: 5px solid #27ae60;
            border-radius: 5px;
        }
        
        .status-icon {
            width: 24px;
            height: 24px;
            margin-right: 15px;
            color: #27ae60;
        }
        
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }
        
        .tool-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 25px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .tool-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border-color: #3498db;
        }
        
        .tool-card h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .tool-card p {
            color: #7f8c8d;
            line-height: 1.6;
            margin-bottom: 15px;
        }
        
        .btn {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .input-group {
            margin-bottom: 20px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .input-group input, .input-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }
        
        .input-group input:focus, .input-group textarea:focus {
            outline: none;
            border-color: #3498db;
        }
        
        .result {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #3498db;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .loading {
            text-align: center;
            color: #3498db;
            font-style: italic;
        }
        
        .error {
            background: #ffeaea;
            border-left-color: #e74c3c;
            color: #c0392b;
        }
        
        .success {
            background: #eafaf1;
            border-left-color: #27ae60;
            color: #27ae60;
        }
        
        .endpoints {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 30px 0;
        }
        
        .endpoints h3 {
            margin-bottom: 15px;
            color: #2c3e50;
        }
        
        .endpoint {
            background: white;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        
        .endpoint a {
            color: #3498db;
            text-decoration: none;
        }
        
        .endpoint a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéâ Word Add-in MCP</h1>
            <p>Complete E2E Working Product - Patent Analysis & MCP Tools</p>
        </div>
        
        <div class="content">
            <div class="status">
                <svg class="status-icon" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                </svg>
                <div>
                    <strong>System Status: HEALTHY</strong><br>
                    Backend API connected on port 9000 with 5 MCP tools ready
                </div>
            </div>
            
            <div class="endpoints">
                <h3>üåê Available Endpoints</h3>
                <div class="endpoint">
                    <strong>API Documentation:</strong> 
                    <a href="http://localhost:9000/docs" target="_blank">http://localhost:9000/docs</a>
                </div>
                <div class="endpoint">
                    <strong>Health Check:</strong> 
                    <a href="http://localhost:9000/health" target="_blank">http://localhost:9000/health</a>
                </div>
                <div class="endpoint">
                    <strong>MCP Tools:</strong> 
                    <a href="http://localhost:9000/api/v1/mcp/tools" target="_blank">http://localhost:9000/api/v1/mcp/tools</a>
                </div>
            </div>
            
            <h2 style="margin-bottom: 20px; color: #2c3e50;">üîß Test MCP Tools</h2>
            
            <div class="tools-grid">
                <div class="tool-card" onclick="showTool('webSearch')">
                    <h3>üåê Web Search</h3>
                    <p>Search the web for patents, research, and general information using Google API integration.</p>
                    <button class="btn">Test Web Search</button>
                </div>
                
                <div class="tool-card" onclick="showTool('priorArt')">
                    <h3>üìã Prior Art Search</h3>
                    <p>Search for prior art patents using PatentsView API with comprehensive analysis and reporting.</p>
                    <button class="btn">Test Prior Art</button>
                </div>
                
                <div class="tool-card" onclick="showTool('claimDrafting')">
                    <h3>‚úçÔ∏è Claim Drafting</h3>
                    <p>Draft patent claims based on invention descriptions using LLM integration.</p>
                    <button class="btn">Test Claim Drafting</button>
                </div>
                
                <div class="tool-card" onclick="showTool('claimAnalysis')">
                    <h3>üîç Claim Analysis</h3>
                    <p>Analyze patent claims for validity, quality, and improvement opportunities.</p>
                    <button class="btn">Test Claim Analysis</button>
                </div>
                
                <div class="tool-card" onclick="showTool('fileReader')">
                    <h3>üìÑ File Reader</h3>
                    <p>Read and process various file formats for patent document analysis.</p>
                    <button class="btn">Test File Reader</button>
                </div>
                
                <div class="tool-card" onclick="showTool('healthCheck')">
                    <h3>üíö System Health</h3>
                    <p>Check the complete system health including all MCP components and services.</p>
                    <button class="btn">Check Health</button>
                </div>
            </div>
            
            <!-- Tool testing interfaces -->
            <div id="toolInterface" style="display: none; margin-top: 30px; padding: 30px; background: #f8f9fa; border-radius: 10px;">
                <h3 id="toolTitle"></h3>
                <div id="toolForm"></div>
                <div id="toolResult"></div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:9000';
        
        function showTool(toolType) {
            const interface = document.getElementById('toolInterface');
            const title = document.getElementById('toolTitle');
            const form = document.getElementById('toolForm');
            const result = document.getElementById('toolResult');
            
            interface.style.display = 'block';
            result.innerHTML = '';
            
            switch(toolType) {
                case 'webSearch':
                    title.textContent = 'üåê Web Search Tool';
                    form.innerHTML = `
                        <div class="input-group">
                            <label>Search Query:</label>
                            <input type="text" id="searchQuery" placeholder="Enter search query..." value="Docker containerization best practices">
                        </div>
                        <div class="input-group">
                            <label>Max Results:</label>
                            <input type="number" id="maxResults" value="5" min="1" max="10">
                        </div>
                        <button class="btn" onclick="executeWebSearch()">Execute Search</button>
                    `;
                    break;
                    
                case 'priorArt':
                    title.textContent = 'üìã Prior Art Search';
                    form.innerHTML = `
                        <div class="input-group">
                            <label>Technology/Invention Query:</label>
                            <input type="text" id="priorArtQuery" placeholder="Describe the technology..." value="machine learning neural network patent">
                        </div>
                        <div class="input-group">
                            <label>Max Results:</label>
                            <input type="number" id="priorArtMax" value="10" min="1" max="50">
                        </div>
                        <button class="btn" onclick="executePriorArtSearch()">Search Prior Art</button>
                    `;
                    break;
                    
                case 'claimDrafting':
                    title.textContent = '‚úçÔ∏è Claim Drafting Tool';
                    form.innerHTML = `
                        <div class="input-group">
                            <label>Invention Description:</label>
                            <textarea id="inventionDesc" rows="4" placeholder="Describe your invention...">A containerized application deployment system that automatically manages SSL certificates and provides load balancing across multiple instances.</textarea>
                        </div>
                        <button class="btn" onclick="executeClaimDrafting()">Draft Claims</button>
                    `;
                    break;
                    
                case 'claimAnalysis':
                    title.textContent = 'üîç Claim Analysis Tool';
                    form.innerHTML = `
                        <div class="input-group">
                            <label>Patent Claims to Analyze:</label>
                            <textarea id="claimsText" rows="6" placeholder="Enter patent claims...">1. A system for containerized application deployment comprising: a container orchestration engine; an SSL certificate management module; and a load balancing component that distributes traffic across multiple container instances.</textarea>
                        </div>
                        <button class="btn" onclick="executeClaimAnalysis()">Analyze Claims</button>
                    `;
                    break;
                    
                case 'fileReader':
                    title.textContent = 'üìÑ File Reader Tool';
                    form.innerHTML = `
                        <div class="input-group">
                            <label>File Path:</label>
                            <input type="text" id="filePath" placeholder="Enter file path..." value="/app/README.md">
                        </div>
                        <button class="btn" onclick="executeFileReader()">Read File</button>
                    `;
                    break;
                    
                case 'healthCheck':
                    title.textContent = 'üíö System Health Check';
                    form.innerHTML = `
                        <button class="btn" onclick="executeHealthCheck()">Check System Health</button>
                    `;
                    break;
            }
            
            interface.scrollIntoView({ behavior: 'smooth' });
        }
        
        async function executeWebSearch() {
            const query = document.getElementById('searchQuery').value;
            const maxResults = document.getElementById('maxResults').value;
            
            await executeAPI('web_search_tool', {
                query: query,
                max_results: parseInt(maxResults)
            });
        }
        
        async function executePriorArtSearch() {
            const query = document.getElementById('priorArtQuery').value;
            const maxResults = document.getElementById('priorArtMax').value;
            
            await executeAPI('prior_art_search_tool', {
                query: query,
                max_results: parseInt(maxResults)
            });
        }
        
        async function executeClaimDrafting() {
            const desc = document.getElementById('inventionDesc').value;
            
            await executeAPI('claim_drafting_tool', {
                user_query: desc
            });
        }
        
        async function executeClaimAnalysis() {
            const claimsText = document.getElementById('claimsText').value;
            const claims = [{
                claim_text: claimsText,
                claim_type: "independent"
            }];
            
            await executeAPI('claim_analysis_tool', {
                claims: claims,
                analysis_type: "comprehensive"
            });
        }
        
        async function executeFileReader() {
            const path = document.getElementById('filePath').value;
            
            await executeAPI('file_reader_tool', {
                path: path
            });
        }
        
        async function executeHealthCheck() {
            try {
                showLoading();
                const response = await fetch(`${API_BASE}/health`);
                const data = await response.json();
                showResult(JSON.stringify(data, null, 2), 'success');
            } catch (error) {
                showResult(`Error: ${error.message}`, 'error');
            }
        }
        
        async function executeAPI(toolName, parameters) {
            try {
                showLoading();
                
                const response = await fetch(`${API_BASE}/api/v1/mcp/tools/${toolName}/execute`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ parameters })
                });
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    showResult(data.result, 'success');
                } else {
                    showResult(`Error: ${data.result || 'Unknown error'}`, 'error');
                }
            } catch (error) {
                showResult(`Network Error: ${error.message}`, 'error');
            }
        }
        
        function showLoading() {
            const result = document.getElementById('toolResult');
            result.innerHTML = '<div class="result loading">üîÑ Executing tool... Please wait...</div>';
        }
        
        function showResult(text, type = '') {
            const result = document.getElementById('toolResult');
            result.innerHTML = `<div class="result ${type}">${text}</div>`;
        }
        
        // Check system status on load
        window.addEventListener('load', async () => {
            try {
                const response = await fetch(`${API_BASE}/health`);
                if (response.ok) {
                    console.log('‚úÖ Backend API is healthy');
                } else {
                    console.warn('‚ö†Ô∏è Backend API responded with error');
                }
            } catch (error) {
                console.error('‚ùå Backend API not available:', error);
                // Update status to show offline
                const status = document.querySelector('.status');
                status.style.background = '#ffeaea';
                status.style.borderLeftColor = '#e74c3c';
                status.innerHTML = `
                    <svg class="status-icon" style="color: #e74c3c;" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
                    </svg>
                    <div>
                        <strong>System Status: OFFLINE</strong><br>
                        Backend API not available - check if container is running on port 9000
                    </div>
                `;
            }
        });
    </script>
</body>
</html>
